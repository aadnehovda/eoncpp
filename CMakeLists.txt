cmake_minimum_required(VERSION 3.12 FATAL_ERROR)
project(Eon LANGUAGES CXX)
set(VERSION "0.1.1")
message(STATUS "Eon C++ v${VERSION}")

# Configuration
set(EON_SOURCES_DIR "${CMAKE_CURRENT_SOURCE_DIR}" CACHE PATH "The directory containing the source files")
set(EON_INSTALL_DIR "${CMAKE_INSTALL_PREFIX}" CACHE PATH "Where to install")
set(EON_LIBRARY_DIR "lib" CACHE STRING "Where to install libraries under EON_INSTALL_DIR")
set(EON_INCLUDE_DIR "include" CACHE STRING "Where to install headers under EON_INSTALL_DIR")
set(EON_TESTS_DIR "eontests" CACHE PATH "Where to install tests under EON_INSTALL_DIR")
set(CMAKE_DEBUG_POSTFIX "_d" CACHE STRING "Postfix to debug builds")

set(EON_BUILD_TESTS ON CACHE BOOL "Include tests in build?")
set(EON_BUILD_FILESYS ON CACHE BOOL "Include the File System package")
set(EON_BUILD_TOKENIZER ON CACHE BOOL "Build the Tokenizer package")
set(EON_BUILD_PARSER ON CACHE BOOL "Build the Eon Parser package")

if(CMAKE_BUILD_TYPE STREQUAL "Debug")
	add_definitions(-D_DEBUG)
endif()
set(CMAKE_CXX_STANDARD 17)
add_definitions(-D_SILENCE_CXX17_CODECVT_HEADER_DEPRECATION_WARNING)

if(EON_BUILD_TESTS)
	add_subdirectory(eontest)
endif()
add_subdirectory(eonterminal)
add_subdirectory(eonstack)
add_subdirectory(eonstring)
add_subdirectory(eonexcept)
add_subdirectory(eonhex)
add_subdirectory(eonregex)
add_subdirectory(eonsource)
if(EON_BUILD_FILESYS)
	add_subdirectory(eonfilesys)
endif()
if(EON_BUILD_TOKENIZER)
	add_subdirectory(eontokenizer)
endif()
if(EON_BUILD_PARSER)
	add_subdirectory(eonparser)
	add_subdirectory(eonscopes)
	add_subdirectory(eontypes)
endif()
